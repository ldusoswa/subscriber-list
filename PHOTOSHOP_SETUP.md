# Photoshop Automation Setup Guide

This guide helps you set up your Photoshop PSD file to work with the automation scripts.

## Prerequisites

- Adobe Photoshop installed on Windows
- Python with `pywin32` package installed
- `levels.csv` file generated by `subtext.py`

## Setting Up Your PSD File with Variables

To enable automatic data updates, your PSD file needs to be configured with **Variables** (also called Data Sets).

### Step 1: Prepare Your CSV File

Your `levels.csv` should have a header row with column names. For example:
```
Name,Level,Months,Amount
John Doe,Tier 1,12,$5
Jane Smith,Tier 2,6,$10
```

### Step 2: Create Text Layers in Photoshop

1. Open `Patreon6.psd` in Photoshop
2. Create text layers for each piece of data you want to display
3. Name each layer descriptively (e.g., "Name1", "Level1", "Months1", etc.)

### Step 3: Define Variables

1. Go to **Image > Variables > Define...**
2. Select a text layer from the dropdown
3. Check the **Text Replacement** checkbox
4. In the **Name** field, enter the exact column name from your CSV (e.g., "Name")
5. Repeat for each text layer you want to link to CSV data
6. Click **OK**

### Step 4: Import Data Set

1. Go to **Image > Variables > Data Sets...**
2. Click **Import...**
3. Browse to your `levels.csv` file
4. In the import dialog:
   - Check **Use First Column for Data Set Names** (if applicable)
   - Match CSV columns to your defined variables
5. Click **OK**

### Step 5: Test the Setup

1. In the **Data Sets** dialog, use the arrow buttons to cycle through different records
2. Verify that your text layers update with data from the CSV
3. If everything looks good, save your PSD file

### Step 6: Run the Automation

Now you can run the automation script:

```bash
python update_patreon_image.py
```

The script will:
- Generate fresh `levels.csv` with latest subscriber data
- Open your PSD in Photoshop
- Update the data source
- Export as `Patreon6.jpg`

## Troubleshooting

### "Document has no data sets/variables configured"

This warning means your PSD doesn't have variables set up. Follow Steps 3-4 above to configure them.

The script will still export your PSD as JPG, but the data won't be automatically updated.

### "Failed to connect to Photoshop"

- Make sure Photoshop is installed
- Try running Photoshop at least once manually before running the script
- Check if COM automation is enabled (it's enabled by default in Photoshop)

### Export Quality Issues

Adjust the `JPEG_QUALITY` setting in `update_photoshop.py`:
- Higher values (90-100) = better quality, larger file size
- Lower values (60-80) = smaller file size, more compression
- Default is 80, which is a good balance

### CSV Data Not Updating

1. Verify `levels.csv` exists and has recent data
2. Check that variable names in Photoshop match CSV column names exactly (case-sensitive)
3. Try manually importing the CSV in Photoshop to test the variable mapping

## Alternative: Manual Data Update

If you prefer not to use variables, you can still use the script to:
1. Generate `levels.csv`
2. Manually update your PSD with the data
3. Run `update_photoshop.py` to just export the JPG

Simply comment out or skip the `update_data_source()` call in the script.

## Advanced: Multiple Data Sets

If your CSV has multiple rows (e.g., multiple patron tiers), you can:

1. Set up variables as described above
2. Import all rows as separate data sets
3. Modify the script to cycle through data sets and export multiple images
4. Or use Photoshop's built-in **File > Export > Data Sets as Files** feature

## Need Help?

- Check Photoshop's documentation on Variables and Data Sets
- Verify your CSV format matches what Photoshop expects
- Test the variable setup manually before automating
